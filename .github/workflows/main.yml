# name: Angular CI/CD

# on:
#   push:
#     branches:
#       - main

# jobs:
#   build:
#     runs-on: ubuntu-latest

#     steps:
#     - name: Checkout Repository
#       uses: actions/checkout@v2

#     - name: Set up Node.js with Yarn
#       uses: actions/setup-node@v3
#       with:
#         node-version: 20.11.1
        

#     - name: Install Yarn
#       run: npm install -g yarn

#     - name: Install Dependencies with Yarn
#       run: yarn install

#     - name: Upgrading Yarn
#       run: yarn upgrade  

#     - name: Build Angular App
#       run: yarn build 

#   deploy:
#     runs-on: ubuntu-latest
#     needs: build
#     steps:
#     - name: Deploy to GitHub Pages
#       uses: JamesIves/github-pages-deploy-action@releases/v4
#       with:
#         GITHUB_TOKEN: ${{ secrets.AUTOMATED_TOKEN }}
#         BRANCH: gh-pages
#         FOLDER: dist/elitco
# ---------------------------------------------+

name: Development Workflow

on:
  push:
    branches:
      - 'dev-*' # Matches branches starting with 'dev-'
      - 'develop'
      - 'staging'
      - 'main'

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Set up Node.js with Yarn
      uses: actions/setup-node@v3
      with:
        node-version: 20.11.1
        # registry-url: 'https://registry.yarnpkg.com'

    - name: Install Yarn
      run: npm install -g yarn

    - name: Upgrading Yarn
      run: yarn upgrade  

    - name: Install Dependencies with Yarn
      run: yarn install

    - name: Build and Test
      run: yarn build

    - name: Deploy to Environment
      if: github.ref == 'refs/heads/main' # Only deploy on the 'main' branch (prod)
      # - name: Deploy to GitHub Pages
      uses: JamesIves/github-pages-deploy-action@releases/v4
      with:
        GITHUB_TOKEN: ${{ secrets.AUTOMATED_TOKEN }}
        BRANCH: gh-pages
        FOLDER: dist/elitco
      # run: |
      #   echo "Deploying to production environment..."
      #   # Add your deployment script or commands here

